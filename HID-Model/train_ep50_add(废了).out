nohup: ignoring input
Using TensorFlow backend.
Glove/glove.twitter.27B.100d.txt
Total 1193514 word vectors.
Loading Data is Done
(83036, 50)
(83036, 50)
(20760, 50)
(20760, 50)
Create model of RNN
WARNING:tensorflow:From /home/chaotf/.local/lib/python3.7/site-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2020-08-06 20:26:58.259904: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-08-06 20:26:58.284841: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2500010000 Hz
2020-08-06 20:26:58.288559: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x564faebf2550 executing computations on platform Host. Devices:
2020-08-06 20:26:58.288619: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2020-08-06 20:27:01.131247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:82:00.0
totalMemory: 10.73GiB freeMemory: 10.57GiB
2020-08-06 20:27:01.131305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2020-08-06 20:27:01.132513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-08-06 20:27:01.132549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2020-08-06 20:27:01.132558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2020-08-06 20:27:01.133067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10284 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:82:00.0, compute capability: 7.5)
2020-08-06 20:27:01.135373: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x564fadcd27f0 executing computations on platform CUDA. Devices:
2020-08-06 20:27:01.135395: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
class: 2
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
x1_input (InputLayer)           (None, 50)           0                                            
__________________________________________________________________________________________________
x2_input (InputLayer)           (None, 50)           0                                            
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 50, 100)      6078700     x1_input[0][0]                   
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 50, 100)      6078700     x2_input[0][0]                   
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 50, 200)      120600      embedding_1[0][0]                
__________________________________________________________________________________________________
bidirectional_3 (Bidirectional) (None, 50, 200)      120600      embedding_2[0][0]                
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 50, 200)      180600      bidirectional_1[0][0]            
__________________________________________________________________________________________________
bidirectional_4 (Bidirectional) (None, 50, 200)      180600      bidirectional_3[0][0]            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 200)          0           bidirectional_2[0][0]            
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 200)          0           bidirectional_4[0][0]            
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 200)          40200       lambda_1[0][0]                   
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 200)          40200       lambda_2[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 200)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 200)          0           dense_2[0][0]                    
__________________________________________________________________________________________________
subtract_1 (Subtract)           (None, 200)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 1)            201         subtract_1[0][0]                 
==================================================================================================
Total params: 12,840,401
Trainable params: 683,001
Non-trainable params: 12,157,400
__________________________________________________________________________________________________
WARNING:tensorflow:From /home/chaotf/.local/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
Train on 83036 samples, validate on 20760 samples
Epoch 1/50
2020-08-06 20:27:13.443166: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally
 - 779s - loss: 0.3702 - acc: 0.8335 - val_loss: 0.3923 - val_acc: 0.8227
Epoch 2/50
 - 780s - loss: 0.3152 - acc: 0.8635 - val_loss: 0.3845 - val_acc: 0.8274
Epoch 3/50
 - 781s - loss: 0.3014 - acc: 0.8699 - val_loss: 0.3913 - val_acc: 0.8263
Epoch 4/50
 - 780s - loss: 0.2924 - acc: 0.8762 - val_loss: 0.3988 - val_acc: 0.8148
Epoch 5/50
 - 770s - loss: 0.2854 - acc: 0.8791 - val_loss: 0.3991 - val_acc: 0.8270
Epoch 6/50
 - 775s - loss: 0.2779 - acc: 0.8826 - val_loss: 0.3939 - val_acc: 0.8298
Epoch 7/50
 - 766s - loss: 0.2715 - acc: 0.8864 - val_loss: 0.3926 - val_acc: 0.8307
Epoch 8/50
 - 773s - loss: 0.2640 - acc: 0.8902 - val_loss: 0.3862 - val_acc: 0.8284
Epoch 9/50
 - 777s - loss: 0.2597 - acc: 0.8935 - val_loss: 0.4122 - val_acc: 0.8295
Epoch 10/50
 - 725s - loss: 0.2545 - acc: 0.8950 - val_loss: 0.4144 - val_acc: 0.8305
Epoch 11/50
 - 715s - loss: 0.2509 - acc: 0.8978 - val_loss: 0.4072 - val_acc: 0.8261
Epoch 12/50
 - 733s - loss: 0.2444 - acc: 0.8995 - val_loss: 0.4143 - val_acc: 0.8225
Epoch 13/50
 - 708s - loss: 0.2419 - acc: 0.9017 - val_loss: 0.4187 - val_acc: 0.8325
Epoch 14/50
 - 774s - loss: 0.2367 - acc: 0.9038 - val_loss: 0.4170 - val_acc: 0.8309
Epoch 15/50
 - 740s - loss: 0.2356 - acc: 0.9040 - val_loss: 0.4576 - val_acc: 0.8231
Epoch 16/50
 - 712s - loss: 0.2313 - acc: 0.9051 - val_loss: 0.4395 - val_acc: 0.8268
Epoch 17/50
 - 777s - loss: 0.2311 - acc: 0.9070 - val_loss: 0.4331 - val_acc: 0.8295
Epoch 18/50
 - 772s - loss: 0.2270 - acc: 0.9090 - val_loss: 0.4436 - val_acc: 0.8273
Epoch 19/50
 - 781s - loss: 0.2239 - acc: 0.9103 - val_loss: 0.4486 - val_acc: 0.8254
Epoch 20/50
 - 778s - loss: 0.2230 - acc: 0.9090 - val_loss: 0.4573 - val_acc: 0.8225
Epoch 21/50
 - 782s - loss: 0.2223 - acc: 0.9114 - val_loss: 0.4668 - val_acc: 0.8224
Epoch 22/50
 - 779s - loss: 0.2181 - acc: 0.9125 - val_loss: 0.4243 - val_acc: 0.8259
Epoch 23/50
 - 781s - loss: 0.2205 - acc: 0.9113 - val_loss: 0.4419 - val_acc: 0.8250
Epoch 24/50
 - 777s - loss: 0.2165 - acc: 0.9127 - val_loss: 0.4579 - val_acc: 0.8267
Epoch 25/50
 - 778s - loss: 0.2145 - acc: 0.9148 - val_loss: 0.4287 - val_acc: 0.8260
Epoch 26/50
 - 778s - loss: 0.2161 - acc: 0.9144 - val_loss: 0.4323 - val_acc: 0.8327
Epoch 27/50
 - 776s - loss: 0.2141 - acc: 0.9140 - val_loss: 0.4725 - val_acc: 0.8320
Epoch 28/50
 - 779s - loss: 0.2139 - acc: 0.9144 - val_loss: 0.4476 - val_acc: 0.8267
Epoch 29/50
 - 777s - loss: 0.2120 - acc: 0.9151 - val_loss: 0.4358 - val_acc: 0.8299
Epoch 30/50
 - 775s - loss: 0.2112 - acc: 0.9161 - val_loss: 0.4852 - val_acc: 0.8223
Epoch 31/50
 - 783s - loss: 0.2119 - acc: 0.9157 - val_loss: 0.4662 - val_acc: 0.8272
Epoch 32/50
 - 781s - loss: 0.2094 - acc: 0.9167 - val_loss: 0.4684 - val_acc: 0.8303
Epoch 33/50
 - 784s - loss: 0.2086 - acc: 0.9172 - val_loss: 0.4314 - val_acc: 0.8279
Epoch 34/50
 - 782s - loss: 0.2080 - acc: 0.9175 - val_loss: 0.4783 - val_acc: 0.8265
Epoch 35/50
 - 785s - loss: 0.2085 - acc: 0.9164 - val_loss: 0.5032 - val_acc: 0.8293
Epoch 36/50
 - 780s - loss: 0.2070 - acc: 0.9177 - val_loss: 0.4664 - val_acc: 0.8299
Epoch 37/50
 - 780s - loss: 0.2085 - acc: 0.9166 - val_loss: 0.4381 - val_acc: 0.8304
Epoch 38/50
 - 778s - loss: 0.2069 - acc: 0.9171 - val_loss: 0.4403 - val_acc: 0.8230
Epoch 39/50
 - 782s - loss: 0.2086 - acc: 0.9172 - val_loss: 0.4888 - val_acc: 0.8297
Epoch 40/50
 - 782s - loss: 0.2072 - acc: 0.9168 - val_loss: 0.4352 - val_acc: 0.8310
Epoch 41/50
 - 782s - loss: 0.2078 - acc: 0.9158 - val_loss: 0.4710 - val_acc: 0.8277
Epoch 42/50
 - 786s - loss: 0.2085 - acc: 0.9163 - val_loss: 0.4602 - val_acc: 0.8279
Epoch 43/50
 - 782s - loss: 0.2082 - acc: 0.9175 - val_loss: 0.4574 - val_acc: 0.8286
Epoch 44/50
 - 779s - loss: 0.2081 - acc: 0.9171 - val_loss: 0.4386 - val_acc: 0.8283
Epoch 45/50
 - 782s - loss: 0.2089 - acc: 0.9166 - val_loss: 0.4396 - val_acc: 0.8340
Epoch 46/50
 - 784s - loss: 0.2097 - acc: 0.9160 - val_loss: 0.4779 - val_acc: 0.8302
Epoch 47/50
 - 782s - loss: 0.2099 - acc: 0.9162 - val_loss: 0.4536 - val_acc: 0.8246
Epoch 48/50
 - 788s - loss: 0.2088 - acc: 0.9160 - val_loss: 0.4753 - val_acc: 0.8277
Epoch 49/50
 - 792s - loss: 0.2071 - acc: 0.9171 - val_loss: 0.4906 - val_acc: 0.8304
Epoch 50/50
 - 796s - loss: 0.2104 - acc: 0.9152 - val_loss: 0.4650 - val_acc: 0.8320
save embedding layer model success
Saving model to disk 

Create Sub model of  1
class: 2
Model: "model_4"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
x1_input (InputLayer)           (None, 50)           0                                            
__________________________________________________________________________________________________
x2_input (InputLayer)           (None, 50)           0                                            
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 50, 100)      6078700     x1_input[0][0]                   
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 50, 100)      6078700     x2_input[0][0]                   
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 50, 200)      120600      embedding_1[0][0]                
__________________________________________________________________________________________________
bidirectional_3 (Bidirectional) (None, 50, 200)      120600      embedding_2[0][0]                
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 50, 200)      180600      bidirectional_1[0][0]            
__________________________________________________________________________________________________
bidirectional_4 (Bidirectional) (None, 50, 200)      180600      bidirectional_3[0][0]            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 200)          0           bidirectional_2[0][0]            
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 200)          0           bidirectional_4[0][0]            
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 200)          40200       lambda_1[0][0]                   
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 200)          40200       lambda_2[0][0]                   
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 200)          0           dense_4[0][0]                    
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 200)          0           dense_5[0][0]                    
__________________________________________________________________________________________________
subtract_2 (Subtract)           (None, 200)          0           dropout_3[0][0]                  
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 1)            201         subtract_2[0][0]                 
==================================================================================================
Total params: 12,840,401
Trainable params: 80,601
Non-trainable params: 12,759,800
__________________________________________________________________________________________________
Train on 39560 samples, validate on 9849 samples
Epoch 1/50
 - 187s - loss: 0.5637 - acc: 0.7317 - val_loss: 0.5301 - val_acc: 0.7455
Epoch 2/50
 - 190s - loss: 0.5190 - acc: 0.7535 - val_loss: 0.5139 - val_acc: 0.7611
Epoch 3/50
 - 191s - loss: 0.5104 - acc: 0.7602 - val_loss: 0.5233 - val_acc: 0.7551
Epoch 4/50
 - 192s - loss: 0.5047 - acc: 0.7634 - val_loss: 0.5123 - val_acc: 0.7594
Epoch 5/50
 - 195s - loss: 0.5006 - acc: 0.7667 - val_loss: 0.5192 - val_acc: 0.7540
Epoch 6/50
 - 194s - loss: 0.4980 - acc: 0.7674 - val_loss: 0.5115 - val_acc: 0.7578
Epoch 7/50
 - 202s - loss: 0.4978 - acc: 0.7687 - val_loss: 0.5148 - val_acc: 0.7624
Epoch 8/50
 - 196s - loss: 0.4964 - acc: 0.7682 - val_loss: 0.5023 - val_acc: 0.7643
Epoch 9/50
 - 199s - loss: 0.4963 - acc: 0.7674 - val_loss: 0.5057 - val_acc: 0.7661
Epoch 10/50
 - 194s - loss: 0.4947 - acc: 0.7692 - val_loss: 0.5155 - val_acc: 0.7522
Epoch 11/50
 - 194s - loss: 0.4946 - acc: 0.7696 - val_loss: 0.5039 - val_acc: 0.7664
Epoch 12/50
 - 195s - loss: 0.4951 - acc: 0.7678 - val_loss: 0.5004 - val_acc: 0.7683
Epoch 13/50
 - 189s - loss: 0.4951 - acc: 0.7678 - val_loss: 0.4999 - val_acc: 0.7670
Epoch 14/50
 - 192s - loss: 0.4918 - acc: 0.7722 - val_loss: 0.5007 - val_acc: 0.7675
Epoch 15/50
 - 196s - loss: 0.4915 - acc: 0.7712 - val_loss: 0.5005 - val_acc: 0.7669
Epoch 16/50
 - 200s - loss: 0.4930 - acc: 0.7697 - val_loss: 0.5057 - val_acc: 0.7655
Epoch 17/50
 - 195s - loss: 0.4933 - acc: 0.7688 - val_loss: 0.5001 - val_acc: 0.7639
Epoch 18/50
 - 198s - loss: 0.4914 - acc: 0.7704 - val_loss: 0.5022 - val_acc: 0.7638
Epoch 19/50
 - 196s - loss: 0.4915 - acc: 0.7702 - val_loss: 0.4978 - val_acc: 0.7742
Epoch 20/50
 - 195s - loss: 0.4909 - acc: 0.7708 - val_loss: 0.4998 - val_acc: 0.7663
Epoch 21/50
 - 192s - loss: 0.4907 - acc: 0.7695 - val_loss: 0.5043 - val_acc: 0.7712
Epoch 22/50
 - 196s - loss: 0.4908 - acc: 0.7708 - val_loss: 0.5003 - val_acc: 0.7688
Epoch 23/50
 - 192s - loss: 0.4908 - acc: 0.7714 - val_loss: 0.5009 - val_acc: 0.7672
Epoch 24/50
 - 200s - loss: 0.4930 - acc: 0.7693 - val_loss: 0.5043 - val_acc: 0.7651
Epoch 25/50
 - 197s - loss: 0.4910 - acc: 0.7710 - val_loss: 0.5093 - val_acc: 0.7630
Epoch 26/50
 - 199s - loss: 0.4899 - acc: 0.7725 - val_loss: 0.5001 - val_acc: 0.7660
Epoch 27/50
 - 191s - loss: 0.4890 - acc: 0.7726 - val_loss: 0.4960 - val_acc: 0.7729
Epoch 28/50
 - 196s - loss: 0.4894 - acc: 0.7722 - val_loss: 0.5011 - val_acc: 0.7672
Epoch 29/50
 - 196s - loss: 0.4907 - acc: 0.7696 - val_loss: 0.4985 - val_acc: 0.7703
Epoch 30/50
 - 193s - loss: 0.4900 - acc: 0.7712 - val_loss: 0.4968 - val_acc: 0.7675
Epoch 31/50
 - 196s - loss: 0.4895 - acc: 0.7710 - val_loss: 0.5054 - val_acc: 0.7752
Epoch 32/50
 - 196s - loss: 0.4886 - acc: 0.7712 - val_loss: 0.4981 - val_acc: 0.7680
Epoch 33/50
 - 194s - loss: 0.4889 - acc: 0.7728 - val_loss: 0.4979 - val_acc: 0.7714
Epoch 34/50
 - 196s - loss: 0.4902 - acc: 0.7724 - val_loss: 0.4963 - val_acc: 0.7671
Epoch 35/50
 - 193s - loss: 0.4891 - acc: 0.7718 - val_loss: 0.4945 - val_acc: 0.7720
Epoch 36/50
 - 194s - loss: 0.4862 - acc: 0.7746 - val_loss: 0.4936 - val_acc: 0.7712
Epoch 37/50
 - 193s - loss: 0.4896 - acc: 0.7750 - val_loss: 0.5019 - val_acc: 0.7603
Epoch 38/50
 - 191s - loss: 0.4893 - acc: 0.7707 - val_loss: 0.5013 - val_acc: 0.7636
Epoch 39/50
 - 189s - loss: 0.4887 - acc: 0.7739 - val_loss: 0.5009 - val_acc: 0.7632
Epoch 40/50
 - 190s - loss: 0.4887 - acc: 0.7725 - val_loss: 0.5009 - val_acc: 0.7708
Epoch 41/50
 - 190s - loss: 0.4888 - acc: 0.7714 - val_loss: 0.4976 - val_acc: 0.7714
Epoch 42/50
 - 190s - loss: 0.4880 - acc: 0.7745 - val_loss: 0.5037 - val_acc: 0.7658
Epoch 43/50
 - 190s - loss: 0.4896 - acc: 0.7718 - val_loss: 0.4998 - val_acc: 0.7721
Epoch 44/50
 - 189s - loss: 0.4896 - acc: 0.7716 - val_loss: 0.5005 - val_acc: 0.7666
Epoch 45/50
 - 189s - loss: 0.4883 - acc: 0.7732 - val_loss: 0.4995 - val_acc: 0.7679
Epoch 46/50
 - 189s - loss: 0.4860 - acc: 0.7747 - val_loss: 0.4954 - val_acc: 0.7712
Epoch 47/50
 - 189s - loss: 0.4869 - acc: 0.7745 - val_loss: 0.4945 - val_acc: 0.7742
Epoch 48/50
 - 189s - loss: 0.4904 - acc: 0.7698 - val_loss: 0.5086 - val_acc: 0.7591
Epoch 49/50
 - 189s - loss: 0.4894 - acc: 0.7720 - val_loss: 0.4991 - val_acc: 0.7700
Epoch 50/50
 - 190s - loss: 0.4861 - acc: 0.7744 - val_loss: 0.5034 - val_acc: 0.7618
Saving model to disk 

