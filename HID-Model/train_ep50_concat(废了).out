nohup: ignoring input
Using TensorFlow backend.
Glove/glove.twitter.27B.100d.txt
Total 1193514 word vectors.
Loading Data is Done
(83036, 50)
(83036, 50)
(20760, 50)
(20760, 50)
Create model of RNN
WARNING:tensorflow:From /home/chaotf/.local/lib/python3.7/site-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2020-08-06 20:27:05.022043: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-08-06 20:27:05.048774: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2500010000 Hz
2020-08-06 20:27:05.051690: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55ac4fd81870 executing computations on platform Host. Devices:
2020-08-06 20:27:05.051724: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2020-08-06 20:27:06.766346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:02:00.0
totalMemory: 10.73GiB freeMemory: 10.57GiB
2020-08-06 20:27:06.766399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2020-08-06 20:27:06.767791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-08-06 20:27:06.767811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2020-08-06 20:27:06.767820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2020-08-06 20:27:06.768385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10284 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:02:00.0, compute capability: 7.5)
2020-08-06 20:27:06.770205: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55ac4f43c760 executing computations on platform CUDA. Devices:
2020-08-06 20:27:06.770230: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
class: 2
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
x1_input (InputLayer)           (None, 50)           0                                            
__________________________________________________________________________________________________
x2_input (InputLayer)           (None, 50)           0                                            
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 50, 100)      6078700     x1_input[0][0]                   
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 50, 100)      6078700     x2_input[0][0]                   
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 50, 200)      120600      embedding_1[0][0]                
__________________________________________________________________________________________________
bidirectional_3 (Bidirectional) (None, 50, 200)      120600      embedding_2[0][0]                
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 50, 200)      180600      bidirectional_1[0][0]            
__________________________________________________________________________________________________
bidirectional_4 (Bidirectional) (None, 50, 200)      180600      bidirectional_3[0][0]            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 200)          0           bidirectional_2[0][0]            
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 200)          0           bidirectional_4[0][0]            
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 200)          40200       lambda_1[0][0]                   
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 200)          40200       lambda_2[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 200)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 200)          0           dense_2[0][0]                    
__________________________________________________________________________________________________
subtract_1 (Subtract)           (None, 200)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 1)            201         subtract_1[0][0]                 
==================================================================================================
Total params: 12,840,401
Trainable params: 683,001
Non-trainable params: 12,157,400
__________________________________________________________________________________________________
WARNING:tensorflow:From /home/chaotf/.local/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
Train on 83036 samples, validate on 20760 samples
Epoch 1/50
2020-08-06 20:27:18.651950: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally
 - 770s - loss: 0.3705 - acc: 0.8337 - val_loss: 0.3903 - val_acc: 0.8236
Epoch 2/50
 - 775s - loss: 0.3151 - acc: 0.8630 - val_loss: 0.3817 - val_acc: 0.8293
Epoch 3/50
 - 777s - loss: 0.3025 - acc: 0.8698 - val_loss: 0.3922 - val_acc: 0.8248
Epoch 4/50
 - 775s - loss: 0.2925 - acc: 0.8752 - val_loss: 0.4113 - val_acc: 0.8121
Epoch 5/50
 - 796s - loss: 0.2853 - acc: 0.8791 - val_loss: 0.3919 - val_acc: 0.8264
Epoch 6/50
 - 794s - loss: 0.2781 - acc: 0.8836 - val_loss: 0.3965 - val_acc: 0.8309
Epoch 7/50
 - 780s - loss: 0.2716 - acc: 0.8863 - val_loss: 0.3880 - val_acc: 0.8334
Epoch 8/50
 - 794s - loss: 0.2651 - acc: 0.8897 - val_loss: 0.3817 - val_acc: 0.8305
Epoch 9/50
 - 786s - loss: 0.2599 - acc: 0.8931 - val_loss: 0.4159 - val_acc: 0.8307
Epoch 10/50
 - 725s - loss: 0.2554 - acc: 0.8953 - val_loss: 0.3983 - val_acc: 0.8308
Epoch 11/50
 - 735s - loss: 0.2495 - acc: 0.8984 - val_loss: 0.4065 - val_acc: 0.8296
Epoch 12/50
 - 744s - loss: 0.2463 - acc: 0.8994 - val_loss: 0.4227 - val_acc: 0.8217
Epoch 13/50
 - 730s - loss: 0.2424 - acc: 0.9014 - val_loss: 0.3951 - val_acc: 0.8343
Epoch 14/50
 - 784s - loss: 0.2376 - acc: 0.9035 - val_loss: 0.4361 - val_acc: 0.8302
Epoch 15/50
 - 743s - loss: 0.2356 - acc: 0.9043 - val_loss: 0.4461 - val_acc: 0.8318
Epoch 16/50
 - 737s - loss: 0.2327 - acc: 0.9062 - val_loss: 0.4256 - val_acc: 0.8307
Epoch 17/50
 - 787s - loss: 0.2323 - acc: 0.9051 - val_loss: 0.4362 - val_acc: 0.8290
Epoch 18/50
 - 789s - loss: 0.2294 - acc: 0.9076 - val_loss: 0.4296 - val_acc: 0.8340
Epoch 19/50
 - 789s - loss: 0.2249 - acc: 0.9097 - val_loss: 0.4416 - val_acc: 0.8309
Epoch 20/50
 - 786s - loss: 0.2246 - acc: 0.9093 - val_loss: 0.4370 - val_acc: 0.8274
Epoch 21/50
 - 786s - loss: 0.2237 - acc: 0.9103 - val_loss: 0.4525 - val_acc: 0.8242
Epoch 22/50
 - 787s - loss: 0.2214 - acc: 0.9102 - val_loss: 0.4327 - val_acc: 0.8276
Epoch 23/50
 - 787s - loss: 0.2202 - acc: 0.9116 - val_loss: 0.4398 - val_acc: 0.8259
Epoch 24/50
 - 796s - loss: 0.2176 - acc: 0.9121 - val_loss: 0.4458 - val_acc: 0.8316
Epoch 25/50
 - 790s - loss: 0.2161 - acc: 0.9139 - val_loss: 0.4373 - val_acc: 0.8293
Epoch 26/50
 - 793s - loss: 0.2154 - acc: 0.9144 - val_loss: 0.4503 - val_acc: 0.8298
Epoch 27/50
 - 789s - loss: 0.2143 - acc: 0.9146 - val_loss: 0.4690 - val_acc: 0.8332
Epoch 28/50
 - 792s - loss: 0.2117 - acc: 0.9155 - val_loss: 0.4487 - val_acc: 0.8306
Epoch 29/50
 - 793s - loss: 0.2127 - acc: 0.9151 - val_loss: 0.4685 - val_acc: 0.8266
Epoch 30/50
 - 786s - loss: 0.2131 - acc: 0.9151 - val_loss: 0.4916 - val_acc: 0.8304
Epoch 31/50
 - 782s - loss: 0.2122 - acc: 0.9148 - val_loss: 0.4394 - val_acc: 0.8314
Epoch 32/50
 - 789s - loss: 0.2118 - acc: 0.9149 - val_loss: 0.4835 - val_acc: 0.8328
Epoch 33/50
 - 784s - loss: 0.2115 - acc: 0.9152 - val_loss: 0.4396 - val_acc: 0.8256
Epoch 34/50
 - 786s - loss: 0.2113 - acc: 0.9155 - val_loss: 0.4752 - val_acc: 0.8290
Epoch 35/50
 - 785s - loss: 0.2119 - acc: 0.9145 - val_loss: 0.4704 - val_acc: 0.8294
Epoch 36/50
 - 792s - loss: 0.2095 - acc: 0.9154 - val_loss: 0.4449 - val_acc: 0.8356
Epoch 37/50
 - 787s - loss: 0.2103 - acc: 0.9158 - val_loss: 0.4465 - val_acc: 0.8339
Epoch 38/50
 - 789s - loss: 0.2115 - acc: 0.9144 - val_loss: 0.4980 - val_acc: 0.8267
Epoch 39/50
 - 784s - loss: 0.2115 - acc: 0.9149 - val_loss: 0.4728 - val_acc: 0.8324
Epoch 40/50
 - 783s - loss: 0.2115 - acc: 0.9164 - val_loss: 0.4472 - val_acc: 0.8339
Epoch 41/50
 - 783s - loss: 0.2097 - acc: 0.9160 - val_loss: 0.4431 - val_acc: 0.8308
Epoch 42/50
 - 784s - loss: 0.2121 - acc: 0.9144 - val_loss: 0.4209 - val_acc: 0.8329
Epoch 43/50
 - 788s - loss: 0.2115 - acc: 0.9158 - val_loss: 0.4655 - val_acc: 0.8359
Epoch 44/50
 - 785s - loss: 0.2091 - acc: 0.9159 - val_loss: 0.4494 - val_acc: 0.8336
Epoch 45/50
 - 783s - loss: 0.2094 - acc: 0.9164 - val_loss: 0.4396 - val_acc: 0.8336
Epoch 46/50
 - 785s - loss: 0.2091 - acc: 0.9157 - val_loss: 0.4592 - val_acc: 0.8327
Epoch 47/50
 - 791s - loss: 0.2106 - acc: 0.9164 - val_loss: 0.4181 - val_acc: 0.8284
Epoch 48/50
 - 800s - loss: 0.2128 - acc: 0.9149 - val_loss: 0.4702 - val_acc: 0.8265
Epoch 49/50
 - 796s - loss: 0.2077 - acc: 0.9170 - val_loss: 0.4657 - val_acc: 0.8318
Epoch 50/50
 - 810s - loss: 0.2088 - acc: 0.9169 - val_loss: 0.4702 - val_acc: 0.8332
save embedding layer model success
Saving model to disk 

Create Sub model of  1
class: 2
Model: "model_4"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
x1_input (InputLayer)           (None, 50)           0                                            
__________________________________________________________________________________________________
x2_input (InputLayer)           (None, 50)           0                                            
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 50, 100)      6078700     x1_input[0][0]                   
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 50, 100)      6078700     x2_input[0][0]                   
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 50, 200)      120600      embedding_1[0][0]                
__________________________________________________________________________________________________
bidirectional_3 (Bidirectional) (None, 50, 200)      120600      embedding_2[0][0]                
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 50, 200)      180600      bidirectional_1[0][0]            
__________________________________________________________________________________________________
bidirectional_4 (Bidirectional) (None, 50, 200)      180600      bidirectional_3[0][0]            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 200)          0           bidirectional_2[0][0]            
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 200)          0           bidirectional_4[0][0]            
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 200)          40200       lambda_1[0][0]                   
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 200)          40200       lambda_2[0][0]                   
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 200)          0           dense_4[0][0]                    
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 200)          0           dense_5[0][0]                    
__________________________________________________________________________________________________
subtract_2 (Subtract)           (None, 200)          0           dropout_3[0][0]                  
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 1)            201         subtract_2[0][0]                 
==================================================================================================
Total params: 12,840,401
Trainable params: 80,601
Non-trainable params: 12,759,800
__________________________________________________________________________________________________
Train on 39560 samples, validate on 9849 samples
Epoch 1/50
 - 202s - loss: 0.5637 - acc: 0.7317 - val_loss: 0.5301 - val_acc: 0.7455
Epoch 2/50
 - 202s - loss: 0.5190 - acc: 0.7535 - val_loss: 0.5139 - val_acc: 0.7611
Epoch 3/50
 - 201s - loss: 0.5104 - acc: 0.7602 - val_loss: 0.5233 - val_acc: 0.7551
Epoch 4/50
 - 195s - loss: 0.5047 - acc: 0.7634 - val_loss: 0.5123 - val_acc: 0.7594
Epoch 5/50
 - 190s - loss: 0.5006 - acc: 0.7667 - val_loss: 0.5192 - val_acc: 0.7540
Epoch 6/50
 - 199s - loss: 0.4980 - acc: 0.7674 - val_loss: 0.5115 - val_acc: 0.7578
Epoch 7/50
 - 197s - loss: 0.4978 - acc: 0.7687 - val_loss: 0.5148 - val_acc: 0.7624
Epoch 8/50
 - 199s - loss: 0.4964 - acc: 0.7681 - val_loss: 0.5023 - val_acc: 0.7643
Epoch 9/50
 - 200s - loss: 0.4964 - acc: 0.7677 - val_loss: 0.5057 - val_acc: 0.7660
Epoch 10/50
 - 201s - loss: 0.4947 - acc: 0.7693 - val_loss: 0.5151 - val_acc: 0.7531
Epoch 11/50
 - 205s - loss: 0.4946 - acc: 0.7696 - val_loss: 0.5039 - val_acc: 0.7660
Epoch 12/50
 - 199s - loss: 0.4951 - acc: 0.7678 - val_loss: 0.5005 - val_acc: 0.7685
Epoch 13/50
 - 195s - loss: 0.4950 - acc: 0.7675 - val_loss: 0.5000 - val_acc: 0.7669
Epoch 14/50
 - 195s - loss: 0.4919 - acc: 0.7720 - val_loss: 0.5008 - val_acc: 0.7669
Epoch 15/50
 - 198s - loss: 0.4917 - acc: 0.7720 - val_loss: 0.5006 - val_acc: 0.7672
Epoch 16/50
 - 193s - loss: 0.4930 - acc: 0.7697 - val_loss: 0.5065 - val_acc: 0.7651
Epoch 17/50
 - 199s - loss: 0.4933 - acc: 0.7688 - val_loss: 0.5003 - val_acc: 0.7637
Epoch 18/50
 - 201s - loss: 0.4919 - acc: 0.7695 - val_loss: 0.5022 - val_acc: 0.7640
Epoch 19/50
 - 197s - loss: 0.4917 - acc: 0.7698 - val_loss: 0.4981 - val_acc: 0.7731
Epoch 20/50
 - 200s - loss: 0.4908 - acc: 0.7700 - val_loss: 0.5009 - val_acc: 0.7632
Epoch 21/50
 - 199s - loss: 0.4911 - acc: 0.7713 - val_loss: 0.5037 - val_acc: 0.7705
Epoch 22/50
 - 190s - loss: 0.4907 - acc: 0.7712 - val_loss: 0.5008 - val_acc: 0.7671
Epoch 23/50
 - 200s - loss: 0.4909 - acc: 0.7724 - val_loss: 0.5018 - val_acc: 0.7647
Epoch 24/50
 - 196s - loss: 0.4925 - acc: 0.7693 - val_loss: 0.5044 - val_acc: 0.7658
Epoch 25/50
 - 202s - loss: 0.4905 - acc: 0.7714 - val_loss: 0.5089 - val_acc: 0.7630
Epoch 26/50
 - 196s - loss: 0.4906 - acc: 0.7711 - val_loss: 0.5012 - val_acc: 0.7646
Epoch 27/50
 - 198s - loss: 0.4893 - acc: 0.7725 - val_loss: 0.4965 - val_acc: 0.7706
Epoch 28/50
 - 202s - loss: 0.4892 - acc: 0.7714 - val_loss: 0.5019 - val_acc: 0.7638
Epoch 29/50
 - 196s - loss: 0.4906 - acc: 0.7694 - val_loss: 0.4979 - val_acc: 0.7713
Epoch 30/50
 - 201s - loss: 0.4895 - acc: 0.7720 - val_loss: 0.4984 - val_acc: 0.7663
Epoch 31/50
 - 196s - loss: 0.4896 - acc: 0.7721 - val_loss: 0.5056 - val_acc: 0.7744
Epoch 32/50
 - 199s - loss: 0.4887 - acc: 0.7711 - val_loss: 0.4971 - val_acc: 0.7706
Epoch 33/50
 - 203s - loss: 0.4895 - acc: 0.7717 - val_loss: 0.4998 - val_acc: 0.7700
Epoch 34/50
 - 195s - loss: 0.4899 - acc: 0.7719 - val_loss: 0.5000 - val_acc: 0.7638
Epoch 35/50
 - 200s - loss: 0.4895 - acc: 0.7710 - val_loss: 0.4951 - val_acc: 0.7724
Epoch 36/50
 - 196s - loss: 0.4866 - acc: 0.7752 - val_loss: 0.4941 - val_acc: 0.7731
Epoch 37/50
 - 195s - loss: 0.4896 - acc: 0.7733 - val_loss: 0.5043 - val_acc: 0.7603
Epoch 38/50
 - 196s - loss: 0.4895 - acc: 0.7704 - val_loss: 0.5035 - val_acc: 0.7640
Epoch 39/50
 - 195s - loss: 0.4890 - acc: 0.7726 - val_loss: 0.5015 - val_acc: 0.7624
Epoch 40/50
 - 195s - loss: 0.4887 - acc: 0.7726 - val_loss: 0.5025 - val_acc: 0.7700
Epoch 41/50
 - 195s - loss: 0.4897 - acc: 0.7715 - val_loss: 0.4983 - val_acc: 0.7676
Epoch 42/50
 - 195s - loss: 0.4877 - acc: 0.7758 - val_loss: 0.5013 - val_acc: 0.7677
Epoch 43/50
 - 195s - loss: 0.4905 - acc: 0.7716 - val_loss: 0.4978 - val_acc: 0.7728
Epoch 44/50
 - 195s - loss: 0.4893 - acc: 0.7729 - val_loss: 0.5014 - val_acc: 0.7669
Epoch 45/50
 - 195s - loss: 0.4887 - acc: 0.7715 - val_loss: 0.4988 - val_acc: 0.7676
Epoch 46/50
 - 194s - loss: 0.4863 - acc: 0.7730 - val_loss: 0.4960 - val_acc: 0.7698
Epoch 47/50
 - 196s - loss: 0.4866 - acc: 0.7727 - val_loss: 0.4975 - val_acc: 0.7713
Epoch 48/50
 - 220s - loss: 0.4896 - acc: 0.7705 - val_loss: 0.5072 - val_acc: 0.7595
Epoch 49/50
 - 220s - loss: 0.4895 - acc: 0.7721 - val_loss: 0.5010 - val_acc: 0.7691
Epoch 50/50
 - 219s - loss: 0.4870 - acc: 0.7735 - val_loss: 0.5014 - val_acc: 0.7648
Saving model to disk 

